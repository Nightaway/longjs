<!DOCTYPE html>
<html style="height: 100%">
<head>
    <meta charset="utf-8">
    <script type="text/javascript" src="torch.js"></script>
</head>
<body style="height: 100%; margin: 0">
        <script type="text/javascript">
            var x = torch.tensor([1.0, 2.0, 3.0, 4.0, 5.0]).transpose();
            var y = torch.tensor([2.0, 4.0, 6.0, 8.0, 10.0]).transpose();;
            var w = torch.tensor([0.1]);
            var b = torch.tensor(0.5);

            var z  = torch.tensor([25]);
            console.log(z.mul(w).add(b).mat[0][0]);
    
            for (var j=0; j<2000; j++) {
                var y_ = x.mul(w).add(b);
                // console.log(y);
                // console.log(y_);
                var loss = y_.sub(y);
                // console.log(loss);
                loss.backward();
                
                // console.log(w);
                // console.log(b);
                for (var i=0; i<w.grad.rows; i++) {
                    w.mat[0][0] -= w.grad.mul1(0.01).mat[i][0];
                    b.mat -= b.grad.mul1(0.01).mat[i][0];
                }
            }
            
            var x  = torch.tensor([50]);
            console.log(x.mul(w).add(b).mat[0][0]);
        </script>
</body>
</html>